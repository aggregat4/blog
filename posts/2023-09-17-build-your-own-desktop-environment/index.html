<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Boris Terzic">
    <meta property="og:title" content="Build Your Own Desktop Environment">
    
    <meta name="description" content="Personal website for Boris Terzic with blog posts on programming and technology">
    <meta property="og:description" content="Personal website for Boris Terzic with blog posts on programming and technology">
    
    
    <meta property="og:url" content="https://blog.boristerzic.com/posts/2023-09-17-build-your-own-desktop-environment/">
    
    <title>Build Your Own Desktop Environment</title>    
    <link rel="canonical" href="https://blog.boristerzic.com/posts/2023-09-17-build-your-own-desktop-environment/" />
    <link rel="icon" href="/favicon.png" type="image/png">
    <link rel="apple-touch-icon" href="/favicon.png">
    
  <style>
    @font-face{font-display:swap;font-family:EB Garamond;font-style:normal;font-weight:400;src:local(""),url(/fonts/eb-garamond-v25-latin-regular.woff2)format("woff2");font-display:swap}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:300;src:local(""),url(/fonts/roboto-slab-v33-latin-300.woff2)format("woff2");font-display:swap}*,:before,:after{box-sizing:border-box}html{-moz-text-size-adjust:none;text-size-adjust:none}body,h1,h2,h3,h4,p,figure,blockquote,dl,dd{margin:0}body{min-height:100vh;line-height:1.5}h1,h2,h3,h4,button,input,label{line-height:1.1}h1,h2,h3,h4{text-wrap:balance}a:not([class]){text-decoration-skip-ink:auto}img,picture{max-width:100%;display:block}input,button,textarea,select{font:inherit}textarea:not([rows]){min-height:10em}:target{scroll-margin-block:5ex}:root{--spacing-xs:8px;--spacing-s:12px;--spacing:24px;--spacing-m:36px;--pompeian-red:#a22e37;--olympic-blue:#247291;--olympic-blue-intensive:#154457;--aconite-violet:#85608e;--aconite-violet-dark:#492552;--neutral-gray:#b5d1cc;--color-gainsboro:#dcdcdc;--color-code-bg:#f5f2f0;--max-readable-column-width:75ch;--link-color:var(--olympic-blue-intensive);--visited-link-color:var(--aconite-violet-dark)}body{font-family:Roboto Slab,serif;font-size:18px}::-moz-selection{background:var(--olympic-blue);color:#fff}::selection{background:var(--olympic-blue);color:#fff}header{max-width:var(--max-readable-column-width);justify-content:center;align-items:center;margin:auto;display:flex}footer{margin:auto;margin-bottom:var(--spacing);justify-content:center;font-size:21px;display:flex}main{max-width:var(--max-readable-column-width);padding:0 var(--spacing)var(--spacing)var(--spacing);margin:auto}main ol{margin:0;padding:0}main ul{margin:0;padding:0}nav{text-transform:uppercase;margin:var(--spacing);border:1px solid #333;border-radius:3px;font-family:sans-serif;font-weight:400;box-shadow:2px 2px 3px #bbb}nav ol{flex-wrap:wrap;justify-content:center;align-items:center;margin:0;padding:0;display:flex}nav ol li{margin:var(--spacing-s);list-style-type:none}nav ol li svg{width:30px}nav ol a{display:flex}nav ol a{color:#000;text-decoration:none}nav ol a:visited{color:#000;text-decoration:none}a{color:var(--link-color)}a:visited{color:var(--visited-link-color)}h1,h2,h3,h4,h5,h6{font-family:EB Garamond,serif;font-weight:400}h1{margin:2.38095ex 0 1ex;font-size:2em;line-height:2.38095ex}h2{margin:2.7027ex 0 1ex;font-size:1.5em;line-height:2.7027ex}h3{margin:3.125ex 0 1ex;font-size:1.3em;line-height:3.125ex}h4{margin:3.57143ex 0 1ex;font-size:1.15em;line-height:3.57143ex}.cover{text-align:center;margin-bottom:var(--spacing);border:1px solid #000;line-height:400%}.cover h1{word-wrap:break-all;border:none}.cover h1{letter-spacing:12px}.cover h2{letter-spacing:12px}article p:first-of-type,h1+p,h2+p,h3+p,h4+p,p+ul{margin-top:var(--spacing-s)}article p{margin:3.125ex 0 0}article pre{margin:3.125ex 0 0}article ul{margin:3.125ex 0 0}article ol{margin:3.125ex 0 0}article p{font-size:1em;line-height:3.125ex}article p code{background-color:var(--color-code-bg);padding:0 4px}article ul{font-size:1em;line-height:3.57143ex}article ol{font-size:1em;line-height:3.57143ex}article .postdate{text-align:left;margin:0;font-family:monospace;display:block}article time{font-size:12px;font-style:italic}article pre{border-radius:3px;font-family:monospace;font-size:16px}article code{border-radius:3px;font-family:monospace;font-size:16px}article pre{padding:var(--spacing-s);background-color:var(--color-code-bg);overflow-x:auto;overflow-y:hidden}ol.postlist time{font-family:monospace;font-size:12px;line-height:1;display:block}ol.postlist li{margin-bottom:var(--spacing-s);list-style-type:none}@media only screen and (min-width:1000px){.postlist li{align-items:center;display:flex}.postlist li time{text-align:right;width:19ch;margin:0 0 0 -19ch;padding-right:1ch;display:inline-block}.postlist li time:after{content:" ¬∑"}.postlist li a{max-width:calc(var(--max-readable-column-width) - calc(2*var(--spacing)))}}
  </style>
  </head>
  <body>
    <header>
      <nav>
        <ol>
          
          <li><a href="/"><svg version="1.1" viewBox="0 0 27.391 25.683" xmlns="http://www.w3.org/2000/svg"><g transform="translate(-42.444 -49.082)"><rect x="42.444" y="49.082" width="27.391" height="25.683" style="font-variation-settings:'wght' 600"/></g><g transform="translate(-42.444 -49.082)"><path d="m48.082 70.46c-0.19587 0-0.3591-0.03265-0.48968-0.09794-0.13058-0.04897-0.19587-0.13874-0.19587-0.26932 0-0.1469 0.05713-0.26116 0.17139-0.34278 0.13058-0.08162 0.29381-0.15507 0.48968-0.22036 0.47336-0.13058 0.88143-0.32646 1.2242-0.58762 0.3591-0.27749 0.64475-0.65291 0.85694-1.1263 0.40807-0.96304 0.79981-1.8853 1.1752-2.7667 0.37542-0.89775 0.73452-1.7873 1.0773-2.6688 0.34278-0.88143 0.68555-1.7792 1.0283-2.6932 0.3591-0.91407 0.7182-1.8771 1.0773-2.8891 0.17955-0.506 0.30197-0.89775 0.36726-1.1752 0.06529-0.27749 0.12242-0.48152 0.17139-0.6121 0.24484-0.06529 0.47336-0.13058 0.68555-0.19587 0.21219-0.06529 0.44887-0.1469 0.71004-0.24484 0.22852-0.11426 0.42439-0.26116 0.58762-0.44071s0.28565-0.31829 0.36726-0.41623c0.04897-0.03265 0.09794-0.04897 0.1469-0.04897 0.04897-0.01632 0.09794 0.01632 0.1469 0.09794 0.04897 0.09793 0.08977 0.19587 0.12242 0.29381 0.03265 0.09794 0.06529 0.20404 0.09794 0.31829 0.3591 1.1589 0.72636 2.3341 1.1018 3.5257 0.39175 1.1752 0.77533 2.3423 1.1508 3.5012 0.37542 1.1426 0.73452 2.2444 1.0773 3.3053 0.3591 1.0447 0.68555 2.0077 0.97936 2.8891 0.1469 0.44071 0.32646 0.79165 0.53865 1.0528 0.22852 0.26116 0.47336 0.4652 0.73452 0.6121 0.27749 0.13058 0.57946 0.23668 0.90591 0.31829 0.2122 0.04897 0.37542 0.11426 0.48968 0.19587 0.11426 0.08162 0.17139 0.19587 0.17139 0.34278 0 0.09794-0.05713 0.17139-0.17139 0.22036-0.09794 0.04897-0.22852 0.07345-0.39174 0.07345-0.29381 0-0.66923-0.0082-1.1263-0.02448-0.44071-0.01632-0.89775-0.03265-1.3711-0.04897-0.47336-0.03265-0.89775-0.04897-1.2732-0.04897-0.32645 0-0.69372 0.0082-1.1018 0.02448-0.39174 0.01632-0.79165 0.03265-1.1997 0.04897-0.39174 0.01632-0.72636 0.02448-1.0038 0.02448-0.16323 0-0.31013-0.02448-0.44071-0.07345-0.11426-0.06529-0.17139-0.15506-0.17139-0.26932 0-0.13058 0.06529-0.23668 0.19587-0.31829 0.13058-0.09794 0.28565-0.16323 0.4652-0.19587 0.58762-0.09794 1.012-0.24484 1.2732-0.44071 0.26116-0.2122 0.3591-0.51416 0.29381-0.90591-0.04897-0.27749-0.12242-0.60394-0.22036-0.97936-0.09794-0.39174-0.20403-0.79165-0.31829-1.1997-0.09794-0.42439-0.20403-0.80797-0.31829-1.1508-0.03265-0.13058-0.08162-0.22036-0.1469-0.26932-0.06529-0.06529-0.18771-0.09794-0.36726-0.09794h-4.4071c-0.11426 0-0.20403 0.0408-0.26932 0.12242-0.06529 0.06529-0.11426 0.17139-0.1469 0.31829-0.06529 0.2122-0.1469 0.45704-0.24484 0.73452-0.08162 0.26116-0.17139 0.53865-0.26932 0.83246-0.08162 0.27749-0.16323 0.53865-0.24484 0.78349-0.06529 0.24484-0.11426 0.45704-0.1469 0.63658-0.08162 0.44071-0.0082 0.79165 0.22036 1.0528 0.24484 0.24484 0.66107 0.44071 1.2487 0.58762 0.44071 0.11426 0.66107 0.28565 0.66107 0.51416 0 0.09794-0.05713 0.17955-0.17139 0.24484-0.09793 0.04897-0.24484 0.07345-0.44071 0.07345-0.37542 0-0.76717-0.01632-1.1752-0.04897-0.40807-0.01632-0.85694-0.02448-1.3466-0.02448-0.48968 0-0.9712 0.02448-1.4446 0.07345-0.45704 0.04897-0.92223 0.07345-1.3956 0.07345zm5.8272-7.1004h3.4033c0.22852 0 0.34278-0.04897 0.34278-0.1469 0-0.04897-0.0082-0.08977-0.02448-0.12242 0-0.03265-0.0082-0.08162-0.02448-0.1469l-1.7139-5.6558c-0.06529-0.22852-0.12242-0.34278-0.17139-0.34278-0.03265 0-0.08977 0.1061-0.17139 0.31829l-2.0567 5.6803c-0.03265 0.08162-0.04897 0.1469-0.04897 0.19587 0 0.08162 0.0408 0.13874 0.12242 0.17139 0.09794 0.03265 0.2122 0.04897 0.34278 0.04897z" fill="#fff" stroke-width=".25504" style="font-variation-settings:'wght' 600" aria-label="(A)"/></g></svg></a></li>
          <li><a href="/pages/blog-styleguide/">Styleguide</a></li>
          <li><a href="/pages/impressum/">About</a></li>
        </ol>
      </nav>
    </header>
    <main>
      <article>
<h1>Build Your Own Desktop Environment</h1>

<time datetime="2023-09-17">2023-09-17</time>

<p>Many Linux users gravitate towards one of the big desktop environments like Gnome and KDE that cover all the bases: they offer window management, a clipboard, a launcher, window switching and much more.</p>
<p>After using Gnome for a long time I switched to XFCE a few years ago: it felt more lightweight, was very customizable and performed very well. I‚Äôm still a big fan.</p>
<p>I recently bought a new AMD graphics card and wanted to try Wayland instead of <a href="http://X.org">X.org</a>, but XFCE doesn‚Äôt support it yet. Instead of switching back to Gnome, I made my own desktop environment. I got ideas from cool Linux desktops on the <a href="https://www.reddit.com/r/unixporn/">unixporn subreddit</a> (it‚Äôs SFW) and picked individual tools to make my own unique setup.</p>
<h2>TL;DR</h2>
<p>In this post I will describe the process of how I identified the things that I need from a desktop environment, how to start from scratch on Arch Linux and build that system up piece by piece. It‚Äôs going to become clear that this is a lot more work than going with one of the established choices but the pay-off is a lot of flexibility and customizability.</p>
<p>It can sometimes be a little bit jankier than whole-cloth complete solutions, but it is often faster in usage, much more attuned to my needs and for me at least, a lot of fun.</p>
<h2>What do I Need?</h2>
<p>I started by compiling a list of all the functions that XFCE provided for me and that I would need to find replacements for:</p>
<ul>
<li>Global keyboard shortcuts</li>
<li>Multi-Monitor support</li>
<li>Workspaces</li>
<li>A list of active windows that allows for quick switching between them</li>
<li>Allow me to switch between windows with ALT-TAB</li>
<li>Support the network manager applet, or have some alternative to it that also allows me to toggle vpns on and off</li>
<li>Screenshot tool support, optimally Flameshot or something like it</li>
<li>A sound widget that allows toggling between various outputs and manage volume in an easy way. Should interact with pipewire/pulseaudio</li>
<li>A customizable clock (calendar weeks, custom date and time pattern) and calendar widget</li>
<li>Some sort of wallpaper management</li>
<li>Allow me to set custom fonts for all on screen elements (big fan of the <a href="https://rsms.me/inter/">Inter</a> font family for UIs)</li>
<li>Desktop notifications</li>
<li>Allow dragging and resizing windows using mouse+modifier keys and clicking <em>anywhere</em> inside the window (this is a killer capability that you can never do without again once you have tried it)</li>
<li>A sensible way to copy and paste things between windows.</li>
</ul>
<p>This list turned out to be bigger than expected.</p>
<h2>Stacking, Tiling or Dynamic: Choose One?</h2>
<p>Before getting to all those individual things we need to answer one fundamental question: what <em>style</em> of window management do I want? Stacking, tiling or dynamic?</p>
<p>Stacking window managers allow windows to cover each other and be freely positioned on the screen. This is the approach that Windows, mac OS, Gnome and KDE provide. They often have additional utilities to also easily arrange windows in simple grids.</p>
<p>Tiling window managers allow windows to be arranged in a grid, with many different approaches possible (and available) but with no windows overlapping any other window. Most tiling window managers allow individual windows to be converted to floating windows when an application is not compatible with the tiling paradigm. Classic examples are <a href="https://i3wm.org/">i3</a>, <a href="https://ratpoison.nongnu.org/">ratpoison</a>, and <a href="https://xmonad.org/">xmonad</a> (Haskell as a configuration language!).</p>
<p>Dynamic window managers usually combine stacking and tiling capabilities in one program and can change layouts dynamically based on some kind of rules. Typical examples are <a href="https://awesomewm.org/">awesome</a> and <a href="https://dwm.suckless.org/">dwm</a>.</p>
<p>I have tried most of these options and concluded that I am a stacking window manager person. I do appreciate the neatness and automation that is possible with tiling window managers. Some of the most well known WMs for Wayland are in fact tiling: <a href="https://swaywm.org/">Sway</a> and <a href="https://hyprland.org/">Hyprland</a>.</p>
<p>The list of stacking window managers that is also Wayland compatible is not large. <a href="https://hikari.acmelabs.space/">Hikari</a> looks interesting but maybe a bit rough. After a brief stint in <a href="https://github.com/WayfireWM/wayfire">Wayfire</a> I settled on <a href="https://labwc.github.io/">Labwc</a>. It does not solve for fancy UI effects, but appears stable, active and offers a subset of features that seems to match what I need.</p>
<h2>Adding a New Custom Desktop Environment in Arch Linux</h2>
<p>Your desktop environment is typically started right after your login to the system using your display manager (or login manager). In graphical display managers like gdm you can select one of several session <em>types</em> from a list. This is where we want to add a new entry for our labwc based desktop environment.</p>
<p>On Arch linux these sessions are stored in <code>/usr/share/xsessions</code> in separate <code>.desktop</code> files. A <code>/usr/share/xsessions/labwc.desktop</code> file could look like this:</p>
<pre><code class="language-ini">[Desktop Entry]
Encoding=UTF-8
Name=labwc
Comment=labwc
Exec=labwc
Type=Application
</code></pre>
<p>When you relogin to your system and select this session type you will have a completely empty desktop and labwc will be running quietly in the background.</p>
<p>Congratulations! You have configured a new desktop environment.</p>
<p>The default setup does not get you a lot of functionality out of the box. You have window management (if you can manage to start things that have windows), virtual desktop management, keybind configurations and a few other affordances.</p>
<p>The labwc <a href="https://labwc.github.io/getting-started.html">Getting Started</a> page is a good place to go next to figure out some helpful configuration options to get you set up with a system that is a <em>little</em> bit more useful.</p>
<h2>The Hunt for More Programs</h2>
<p>We now need to figure out what programs and configurations we can use to restore all those capabilities that I listed in the beginning of the article. I‚Äôll take you through some of the options that I selected for my use case.</p>
<h3>Wallpaper</h3>
<p>Important things first: how do I set my wallpaper? You can use a variety of programs but I settled on <a href="https://github.com/swaywm/swaybg">swaybg</a> and added the following stanza to my <code>~/.config/labwc/autostart</code>:</p>
<pre><code class="language-bash">swaybg -m fill -i somepicture.jpg  &gt;/dev/null 2&gt;&amp;1 &amp;
</code></pre>
<h3>Panel</h3>
<p>By default labwc just shows an empty desktop and there are no UI elements to open menus, have a tasktray, show running programs, etc. Labwc delegates all that to external programs.</p>
<p>I chose <a href="https://github.com/Alexays/Waybar">waybar</a> as my panel/bar implementation. It has a bunch of standard modules for functionality such as showing active windows or a tasktray, but it also allows for custom modules where you can customise what is displayed and what programs are run on what events. It can be a very powerful way to get some nice custom widgets for your particular setup.</p>
<p>Mine currently looks like this:</p>
<p><a href="/images/waybar-screenshot-left.png"><img src="/images/waybar-screenshot-left.png" alt="waybar screenshot"></a></p>
<p><a href="/images/waybar-screenshot-right.png"><img src="/images/waybar-screenshot-right.png" alt="waybar screenshot"></a></p>
<p>And this is configured through <code>~/.config/waybar/config</code>. Note that I use <a href="https://github.com/ArtsyMacaw/wlogout">wlogout</a> to provide a reboot/shutdown/logout menu from waybar.</p>
<p>Here‚Äôs my current configuration:</p>
<pre><code class="language-json">{
    &quot;layer&quot;: &quot;top&quot;, // Waybar at top layer
    &quot;position&quot;: &quot;bottom&quot;, // Waybar position (top|bottom|left|right)
    &quot;height&quot;: 34, // Waybar height (to be removed for auto height)
    &quot;spacing&quot;: 12, // Gaps between modules (4px)
    &quot;modules-left&quot;: [
      &quot;wlr/taskbar&quot; 
    ],
    &quot;modules-right&quot;: [
      &quot;custom/audio_idle_inhibitor&quot;,
      &quot;memory&quot;,
      &quot;custom/audio-switcher&quot;,
        &quot;pulseaudio&quot;,
        &quot;tray&quot;,
        &quot;clock&quot;,
        &quot;custom/logout&quot;
    ],
    &quot;wlr/taskbar&quot;: {
      &quot;all-outputs&quot;: false,
        &quot;format&quot;: &quot;{icon} {title:.15}&quot;,
        &quot;on-click&quot;: &quot;minimize-raise&quot;,
    },
    &quot;memory&quot;: {
      &quot;interval&quot;: 30,
//    &quot;format&quot;: &quot;RAM: {used:0.1f}G/{total:0.1f}G&quot;   
    &quot;format&quot;: &quot;RAM: {}%&quot;    
    },
    &quot;tray&quot;: {
        &quot;icon-size&quot;: 21,
        &quot;spacing&quot;: 10
    },
    &quot;clock&quot;: {
        &quot;timezone&quot;: &quot;Europe/Berlin&quot;,
        &quot;tooltip-format&quot;: &quot;&lt;big&gt;{:%Y %B}&lt;/big&gt;\n&lt;tt&gt;&lt;small&gt;{calendar}&lt;/small&gt;&lt;/tt&gt;&quot;,
        &quot;format&quot;: &quot;{:  KW%V   %d %b   %H:%M  }&quot;,
        &quot;on-click&quot;: &quot;orage&quot;        
    },
    &quot;pulseaudio&quot;: {
        &quot;scroll-step&quot;: 2, // %, can be a float
        &quot;format&quot;: &quot;{volume}% {icon} {format_source}&quot;,
        &quot;format-bluetooth&quot;: &quot;{volume}% {icon}Ôäî {format_source}&quot;,
        &quot;format-bluetooth-muted&quot;: &quot;Ôö© {icon}Ôäî {format_source}&quot;,
        &quot;format-muted&quot;: &quot;üîá {format_source}&quot;,
        &quot;format-source&quot;: &quot;{volume}% ÔÑ∞ &quot;,
        &quot;format-source-muted&quot;: &quot;ÔÑ± &quot;,
        &quot;format-icons&quot;: {
            &quot;headphone&quot;: &quot;ÔÄ•&quot;,
            &quot;phone&quot;: &quot;ÔÇï&quot;,
            &quot;portable&quot;: &quot;ÔÇï&quot;,
            &quot;car&quot;: &quot;ÔÜπ&quot;,
            &quot;default&quot;: [&quot;ÔÄ¶&quot;, &quot;ÔÄß&quot;, &quot;ÔÄ®&quot;]
        },
        &quot;on-click&quot;: &quot;pavucontrol&quot;
    },
    &quot;custom/logout&quot;: {
      &quot;format&quot;: &quot;‚èº   {}&quot;,
      &quot;exec&quot;: &quot;whoami&quot;,
      &quot;on-click&quot;: &quot;wlogout -m 400&quot;
    },
    // Auto updating the text based on exec-on-event true does not work.
    // A workaround to use signals to notify waybar to update the module also does not work.
    // This pull request seems relevant: https://github.com/Alexays/Waybar/pull/1784
    // Polling like this with an interval of every 2 seconds is suboptimal
    &quot;custom/audio-switcher&quot;: {
      &quot;format&quot;: &quot;Out: {}&quot;,
      &quot;exec&quot;: &quot;get-pa-sink-name.sh&quot;,
      // &quot;exec-on-event&quot;: true,
      &quot;interval&quot;: 2,
      &quot;on-click&quot;: &quot;switch-pa-sinks.sh&quot;
     },
     &quot;custom/audio_idle_inhibitor&quot;: {
        &quot;format&quot;: &quot;{icon}&quot;,
        &quot;exec&quot;: &quot;sway-audio-idle-inhibit --dry-print-both-waybar&quot;,
        &quot;exec-if&quot;: &quot;which sway-audio-idle-inhibit&quot;,
        &quot;return-type&quot;: &quot;json&quot;,
        &quot;format-icons&quot;: {
          &quot;output&quot;: &quot;ÔÖÑ &quot;,
          &quot;input&quot;: &quot;ÔÑ∞ &quot;,
          &quot;output-input&quot;: &quot;ÔÖÑ  ÔÑ∞ &quot;,
          &quot;none&quot;: &quot;&quot;
        }
     }
}
</code></pre>
<h3>Lock Screen</h3>
<p>This one turned into a combination of four different utilities: <a href="https://github.com/swaywm/swayidle">swayidle</a> can run a command after a certain idle period, <a href="https://git.sr.ht/~emersion/chayang">chayang</a> can slowly fade the screen to black and <a href="https://github.com/swaywm/swaylock">swaylock</a> can lock the screen. Additionally you can use <a href="https://sr.ht/~leon_plickat/wlopm/">wlopm</a> to put the screen in power saving mode and resume it again when swayidle wakes up.</p>
<p>This is my configuration from <code>~/.config/labwc/autostart</code>:</p>
<pre><code class="language-sh">swayidle -w \
  timeout 900 'chayang &amp;&amp; swaylock -f -c 000000' \
  timeout 1800 'wlopm --off \*' \
  resume 'wlopm --on \*' \
  before-sleep 'swaylock -f -c 000000' &gt;/dev/null 2&gt;&amp;1 &amp;
</code></pre>
<h3>Notifications</h3>
<p>There are a bunch of notification options but I chose <a href="https://github.com/emersion/mako">mako</a>.</p>
<h3>Multi-Monitor Management</h3>
<p>The author of mako and chayang also authors a utility called <a href="https://wayland.emersion.fr/kanshi/">kanshi</a> which can do a job similar to autorandr and automatically adapt your configuration based on the amount and kind of monitors that are active.</p>
<p>I had some trouble figuring out what my monitors <em>are called</em> so that I can identify them with kanshi. I had to start into a <code>sway</code> session and run <code>swaymsg -t get_outputs</code> to get the names of the monitors.</p>
<p>I have a 24 inch monitor in vertical orientation on the left and a 27 inch monitor horizontally in the center. I normally use only the center one and sometimes activate the vertical monitor on the left. I want kanshi to react to these changes dynamically so my configuration in <code>.config/kanshi/config</code> looks like this:</p>
<pre><code class="language-text">profile single {
  output DP-4 position 0,0 mode 2560x1440
}

profile dual {
  output DP-4 position 1200,0 mode 2560x1440
  output DP-1 position 0,0 mode 1920x1200 transform 90
}
</code></pre>
<h3>Workspaces</h3>
<p>Waybar has a built-in workspace switcher module but it is not compatible with labwc (yet?). A particular Wayland protocol needs to be implemented I think. The built-in labwc switcher is sufficient for my purposes.</p>
<h3>Trayicons</h3>
<p>I enjoy having a few applications running in the background with an icon in the ‚Äútray‚Äù or a similar construct. The network manager applet is most important here, but the Jetbrains launcher, 1Password and Flame shot are also very useful.</p>
<p>Waybar has a built in tray widget that seems to work well. Any application that you want to have active and visible in the tray needs to be started in your <code>~/.config/labwc/autostart</code> file:</p>
<pre><code class="language-bash">1password --silent &gt;/dev/null 2&gt;&amp;1 &amp;
nm-applet --indicator &gt;/dev/null 2&gt;&amp;1 &amp;
jetbrains-toolbox --minimize &gt;/dev/null 2&gt;&amp;1 &amp;
# Flameshot _does_ support wayland (see https://github.com/flameshot-org/flameshot/blob/master/docs/Sway%20and%20wlroots%20support.md) but it only recognizes sway as a value for XDG_CURRENT_DESKTOP
# Also starting it soon during start will prevent the tray icon from showing up, hence the sleep
sleep 2 &amp;&amp; XDG_CURRENT_DESKTOP=sway flameshot &gt;/dev/null 2&gt;&amp;1
</code></pre>
<p>I include the special casing for flameshot as it is still something we need to do as long as not all kinks are worked out in the Wayland support of various apps.</p>
<h3>Fonts</h3>
<p>Labwc has the ability to configure fonts for window titles and other places that are managed by it. This configuration is part of the <code>~/.config/labwc/rc.xml</code> file:</p>
<pre><code class="language-xml">&lt;theme&gt;
    &lt;name&gt;Numix&lt;/name&gt;
    &lt;cornerRadius&gt;6&lt;/cornerRadius&gt;
    &lt;font place=&quot;ActiveWindow&quot;&gt;
      &lt;name&gt;Inter&lt;/name&gt;
      &lt;size&gt;11&lt;/size&gt;
      &lt;slant&gt;normal&lt;/slant&gt;
      &lt;weight&gt;bold&lt;/weight&gt;
    &lt;/font&gt;
    &lt;font place=&quot;MenuItem&quot;&gt;
      &lt;name&gt;Inter&lt;/name&gt;
      &lt;size&gt;11&lt;/size&gt;
      &lt;slant&gt;normal&lt;/slant&gt;
      &lt;weight&gt;normal&lt;/weight&gt;
    &lt;/font&gt;
    &lt;font place=&quot;OnScreenDisplay&quot;&gt;
      &lt;name&gt;Inter&lt;/name&gt;
      &lt;size&gt;11&lt;/size&gt;
      &lt;slant&gt;normal&lt;/slant&gt;
      &lt;weight&gt;normal&lt;/weight&gt;
    &lt;/font&gt;
  &lt;/theme&gt;
</code></pre>
<h3>Keyboard Shortcuts</h3>
<p>The same configuration files allow binding keys to certain function. I was able to map the media keys on my keyboard to <code>pactl</code> invocations to lower, raise and mute the volume:</p>
<pre><code class="language-xml">    &lt;keybind key=&quot;XF86_AudioLowerVolume&quot;&gt;
      &lt;action name=&quot;Execute&quot; command=&quot;pactl set-sink-volume 0 -5%&quot; /&gt;
    &lt;/keybind&gt;
    &lt;keybind key=&quot;XF86_AudioRaiseVolume&quot;&gt;
      &lt;action name=&quot;Execute&quot; command=&quot;pactl set-sink-volume 0 +5%&quot; /&gt;
    &lt;/keybind&gt;
    &lt;keybind key=&quot;XF86_AudioMute&quot;&gt;
      &lt;action name=&quot;Execute&quot; command=&quot;pactl set-sink-mute 0 toggle&quot; /&gt;
    &lt;/keybind&gt;
</code></pre>
<p>Extremely important for me is the ability to easily move windows with the mouse without having to target the tiny resize handles of windows. Labwc supports ALT + left mouse drag for window dragging in any location and ALT + right drag for resizing windows in any location.</p>
<h3>Keyboard Layout</h3>
<p>I had to configure what keyboard layout and what variant to use, this was simply done through two environment variables in <code>~/.config/labwc/environment</code>. These are my specific settings, adapt as needed of course:</p>
<pre><code class="language-sh">XKB_DEFAULT_LAYOUT=us
XKB_DEFAULT_VARIANT=de_se_fi
</code></pre>
<h3>Secrets Management</h3>
<p>In order to have session based secrets and SSH passphrase mangement I start <code>gnome-keyring-daemon</code> with the following lines in <code>~/.config/labwc/autostart</code>:</p>
<pre><code class="language-sh">dbus-update-activation-environment DISPLAY XAUTHORITY WAYLAND_DISPLAY
gnome-keyring-daemon --start --components=pkcs11,secrets,ssh -d
</code></pre>
<p>It‚Äôs important to also make sure the <code>SSH_AUTH_SOCK</code> environment variable is set in <code>~/.config/labwc/environment</code>:</p>
<pre><code class="language-sh">SSH_AUTH_SOCK=/run/user/1000/keyring/ssh
</code></pre>
<h2>Various Other Wayland Tools</h2>
<p>In addition to the desktop environment it may be useful to have native Wayland alternatives for certain tools. Many X only tools can work under Wayland with Xwayland (for example IntelliJj Idea) but a lot of tools have native Wayland support built in.</p>
<h3>Foot Terminal</h3>
<p>I installed the <a href="https://codeberg.org/dnkl/foot/wiki">foot terminal emulator</a> since it seems to be fast and it is wayland native. This terminal requires servers you access over ssh to have the termininfo package installed. My particular remote Debian server has a <code>foot-terminfo</code> package that works well.</p>


</article>

    </main>
    <footer>
      
      ‚∏ì
    </footer>
  </body>
</html>
